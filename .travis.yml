language: node_js
env:
  global:
  - CC_TEST_REPORTER_ID=582049af9c14d77288f80b0ed20a7c57c34bb94796ea8f09d2cd593c21dfbe8c
matrix:
  include:
  - node_js: '12'
cache:
  directories:
  - node_modules
install: yarn
after_success: yarn coverage
before_script:
- psql -c 'create database testdb;' -U postgres
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script:
- yarn test
after_script:
- "./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
services:
- postgresql
addons:
  postgresql: '10'
  apt:
    packages:
    - postgresql-10
    - postgresql-client-10
before_install:
- sudo cp /etc/postgresql/{9.6,10}/main/pg_hba.conf
- sudo /etc/init.d/postgresql restart
deploy:
  provider: heroku
  app:
    master: remind2-test
  api_key:
    secure: Tli4Y16H1uf7YXTtJSc3KTjzhuaBP/TybWwfBppYZqxNdPAexRW2gMmy1ndqlDQljQaZP2/yT/38JERyTkRH+7/SEJfuFKfCZV/3ZrOYryqoaKocke77jzDC28vFmH1566VRD2vE7huXIVeg2D12VfPt7W5D3TxPG+AuczYm/CZCKwVdPE8bNRrljg4oK4ePPVeNDDT0GKr3ziUdAUzsws00akz/LRqq+g/cNnDzmIfO4xAyqAqpSS7hHrWdz9vaJm456XiChrZVUNhR2sRS7ebBBhwVLBB0e/RNFuZPtlvg4Q1SvrfTNln4Hu4QsbOFUoyutlBy3fbXTFVe3BFk8L30DpYw4yH+hw3CTFJ0PGdLTpnwYiH/Yj5Idioueq5FULA40Omaj/2ADgg01fyefPEHDV488vRbWFT8PppqWuNC+XZqOrEGZ2Ixu2pMydcfWhrgnoUaQp5ly4lqbekLjy55PvvlaaFfSqogZOAnVBxzod6PqhcN4FkXiZQr5O/X+jyuKHn6+ivXXF+Vm81ANGp/y+QpenBrJC5YA73OxAc3BwTd6ZUkkbA7/C/gEl1oXk14v+T25iqGd+axRhgxaoT2EuxVffqTkpNKy1lGbcBCrtDIa3wJ+i6lwsMlX6C/EHwUkxMwe9JSzfCu6JEIwTMAIFrN0R9HiHSlXgdYGxw=
